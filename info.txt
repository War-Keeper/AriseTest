{
  "component": "FacetFilterBar",
  "source_page": "gemsny.com/sapphires/basic-search",
  "snapshot_date": "2025-08-15",
  "purpose": "Configurable multi-facet product filter with carousels, range sliders, dropdown multiselects, sorting, paging, and result toolbar.",

  "layout": {
    "sticky_bar": {
      "selector": "#filter-desktop-sticky",
      "sticky": true
    },
    "grid_system": "Bootstrap-like (row/col-md-*/col-lg-*)",
    "sections": [
      {
        "id": "top_carousels",
        "columns": [
          { "label": "Gem Type", "widget": "carousel-multi", "target": "gem" },
          { "label": "Sapphire Color", "widget": "carousel-multi", "target": "colors" },
          { "label": "Shape", "widget": "carousel-multi", "target": "shapes" }
        ]
      },
      {
        "id": "primary_ranges",
        "columns": [
          { "label": "Carat", "widget": "range-slider", "target": "carat" },
          { "label": "Price (USD)", "widget": "range-slider", "target": "price" },
          { "label": "Quality Grade", "widget": "range-slider-stepped", "target": "quality" }
        ]
      },
      {
        "id": "additional_facets_row",
        "columns": [
          { "label": "Origin", "widget": "dropdown-multiselect", "target": "origin" },
          { "label": "Single/Pair", "widget": "dropdown-multiselect", "target": "pair" },
          { "label": "Clarity", "widget": "range-slider-vertical-stepped", "target": "clarity" },
          { "label": "Transparency", "widget": "range-slider-vertical-stepped", "target": "transparency" },
          { "label": "Enhancement", "widget": "dropdown-multiselect", "target": "treatments" },
          { "label": "Color Intensity", "widget": "dropdown-multiselect", "target": "color_intensity", "initial_display": "hidden" },
          { "label": "Certificate", "widget": "dropdown-multiselect", "target": "certificate" },
          { "label": "Length", "widget": "range-slider", "target": "length" },
          { "label": "Width", "widget": "range-slider", "target": "width" },
          { "label": "L/W", "widget": "range-slider", "target": "lwr" }
        ],
        "toggle": {
          "button_selector": ".showfilter.additionalfilter.filterdisplay",
          "show_text_selector": ".showfilters",
          "hide_text_selector": ".hidefilters",
          "content_selector": ".new-filters",
          "starts_collapsed": true
        }
      },
      {
        "id": "results_toolbar",
        "elements": {
          "result_count_selector": "#total_count",
          "tabs": ["Result", "Compare"],
          "compare_count_selector": "#compCnt",
          "sort": { "selector": "#bottom_sortby" },
          "per_page": { "selector": "#short_number" },
          "view_toggle": {
            "list_selector": ".listviewproduct",
            "grid_selector": ".gridviewwproduct",
            "default": "grid"
          }
        }
      }
    ]
  },

  "libraries": {
    "swiper": {
      "used_for": ["gem", "colors", "shapes"],
      "nav_buttons": [".swiper-button-next*", ".swiper-button-prev*"]
    },
    "jquery_ui_slider": {
      "used_for": ["carat", "price", "quality", "clarity", "transparency", "length", "width", "lwr"],
      "orientation": {
        "clarity": "vertical",
        "transparency": "vertical",
        "others": "horizontal"
      }
    },
    "tooltips": {
      "framework": "Bootstrap-like",
      "trigger": "data-toggle=\"tooltip\"",
      "title_attr": "data-original-title"
    },
    "custom_select": {
      "plugin_hint": "selectBox-like",
      "wrapper_class": "sbHolder",
      "mirror_elements": ["sbSelector", "sbOptions"]
    },
    "icons": {
      "prefixes": ["icon-diamond-icon", "icon-shapes-*", "icon-grid-view-icon", "icon-list-view", "icon-compare-icon"]
    }
  },

  "data_attributes": {
    "checkbox_inputs": {
      "selector": "input.checkbox",
      "keys": {
        "data-target": "facetKey",
        "data": "valueCanonical",
        "v": "valueDisplay"
      }
    },
    "facet_containers": {
      "dropdown": ".select-choose__list[data-target=\"{facet}\"]",
      "carousel": "ul.gemType.swiper-wrapper",
      "range_hidden_inputs": [
        "{facet}_low", "{facet}_high",
        "min_{facet}", "max_{facet}"
      ]
    }
  },

  "state_model": {
    "facets": {
      "gem": { "type": "multi", "widget": "carousel-multi" },
      "colors": { "type": "multi", "widget": "carousel-multi" },
      "shapes": { "type": "multi", "widget": "carousel-multi" },
      "carat": { "type": "range", "min": 0.01, "max": 89, "units": "ct" },
      "price": { "type": "range", "min": 200, "max": 2002850, "units": "USD" },
      "quality": {
        "type": "range-stepped",
        "scale": [
          { "value": 1, "label": "A", "desc": "Good" },
          { "value": 2, "label": "AA", "desc": "Very Good" },
          { "value": 3, "label": "AAA", "desc": "Excellent" },
          { "value": 4, "label": "AAAA", "desc": "Heirloom" },
          { "value": 5, "label": "AAAAA", "desc": "Untreated Heirloom" }
        ],
        "min": 0,
        "max": 5
      },
      "origin": { "type": "multi" },
      "pair": {
        "type": "multi",
        "mapping": [
          { "code": "S", "label": "Single" },
          { "code": "P", "label": "Pair" }
        ]
      },
      "clarity": {
        "type": "range-stepped",
        "orientation": "vertical",
        "scale": [
          { "value": 1, "label": "Included" },
          { "value": 2, "label": "Moderately Included" },
          { "value": 3, "label": "Slightly Included" },
          { "value": 4, "label": "Very Slightly Included" },
          { "value": 5, "label": "Eye Clean" }
        ],
        "min": 0,
        "max": 5
      },
      "transparency": {
        "type": "range-stepped",
        "orientation": "vertical",
        "scale": [
          { "value": 1, "label": "Opaque" },
          { "value": 2, "label": "Semi Transparent" },
          { "value": 3, "label": "Transparent" }
        ],
        "min": 0,
        "max": 3
      },
      "treatments": {
        "type": "multi",
        "values": ["Heated", "Untreated", "Beryllium"],
        "labels": { "None": "Untreated" }
      },
      "color_intensity": { "type": "multi", "initial_display": "hidden" },
      "certificate": { "type": "multi", "values": ["GIA", "AGL"] },
      "length": { "type": "range", "min": 3.5, "max": 50, "units": "mm" },
      "width": { "type": "range", "min": 2.5, "max": 1000, "units": "mm" },
      "lwr": { "type": "range", "min": 0.05, "max": 2.6, "label": "Length/Width Ratio" }
    },
    "sort": {
      "default": "FHTL",
      "options": [
        { "code": "FHTL", "label": "Sort By Featured" },
        { "code": "PLTH", "label": "Price Low to High" },
        { "code": "PHTL", "label": "Price High to Low" },
        { "code": "WLTH", "label": "Weight Low to High" },
        { "code": "WHTL", "label": "Weight High to Low" },
        { "code": "QHTL", "label": "Quality High to Low" },
        { "code": "QLTH", "label": "Quality Low to High" }
      ]
    },
    "per_page": { "default": 24, "options": [24, 36, 48] },
    "views": { "default": "gallery", "options": ["list", "gallery"] },
    "compare": { "enabled": true, "counter_selector": "#compCnt" }
  },

  "enumerations_from_markup": {
    "gem": [
      "Sapphire", "Ruby", "Emerald", "Alexandrite", "Tsavorite", "Tanzanite",
      "Hessonite", "Aquamarine", "Peridot", "Pink-Tourmaline",
      "Spinel", "Paraiba-Tourmaline", "Morganite", "Cats-Eye"
    ],
    "colors": [
      "Blue", "Yellow", "Pink", "White", "Purple", "Lavender",
      "Green", "Padparadscha", "Peach", "Orange", "Teal", "Change"
    ],
    "shapes": [
      "Round", "Oval", "Cushion", "Emerald", "Asscher", "Pear",
      "Square", "Heart", "Marquise", "Trillion", "Cabochon", "Star"
    ],
    "origin": ["Madagascar", "Ceylon", "Thailand", "Australian", "Burma", "Ethiopia"],
    "pair": ["Single", "Pair"],
    "certificate": ["GIA", "AGL"]
  },

  "selectors_and_hooks": {
    "carousels": {
      "gem": ".gems_type_slider .gemtypelist",
      "colors": ".color-stone_slider .gemcolor",
      "shapes": ".shape-stone_slider .gemType"
    },
    "range_sliders": {
      "carat": "#slider-carat-range",
      "price": "#slider-price-range",
      "quality": "#qualitySlider",
      "clarity": "#claritySlider",
      "transparency": "#transparencySlider",
      "length": "#slider-length-range",
      "width": "#slider-width-range",
      "lwr": "#slider-lwr-range"
    },
    "range_inputs": {
      "carat": { "min": "#dmincarat", "max": "#dmaxcarat" },
      "price": { "min": "#dminprice", "max": "#dmaxprice" },
      "length": { "min": "#dminlength", "max": "#dmaxlength" },
      "width": { "min": "#dminwidth", "max": "#dmaxwidth" },
      "lwr": { "min": "#dminlwr", "max": "#dmaxlwr" }
    },
    "hidden_bounds": {
      "carat": { "low": "#carat_low", "high": "#carat_high", "min": "#min_carat", "max": "#max_carat" },
      "price": { "low": "#price_low", "high": "#price_high", "min": "#min_price", "max": "#max_price" },
      "quality": { "low": "#quality_low", "high": "#quality_high", "labels": "#quality_labels", "values": "#quality_values" },
      "clarity": { "low": "#clarity_low", "high": "#clarity_high", "labels": "#clarity_labels", "values": "#clarity_values" },
      "transparency": { "low": "#transparency_low", "high": "#transparency_high", "labels": "#transparency_labels", "values": "#transparency_values" },
      "length": { "low": "#length_low", "high": "#length_high", "min": "#min_length", "max": "#max_length" },
      "width": { "low": "#width_low", "high": "#width_high", "min": "#min_width", "max": "#max_width" },
      "lwr": { "low": "#lwr_low", "high": "#lwr_high", "min": "#min_lwr", "max": "#max_lwr" }
    },
    "dropdowns": ".select-choose",
    "dropdown_title": ".select-choose__title",
    "dropdown_list": ".select-choose__list",
    "result_count": "#total_count",
    "sort_select": "#bottom_sortby",
    "per_page_select": "#short_number",
    "view_buttons": { "list": ".listviewproduct", "grid": ".gridviewwproduct" }
  },

  "interaction_contract": {
    "checkbox_click": {
      "target": "input.checkbox",
      "reads": ["data-target", "data", "v"],
      "effect": "toggle value in state[facetKey]; refresh results; update count."
    },
    "carousel_nav": {
      "widgets": ["gem", "colors", "shapes"],
      "ux": "horizontal scroll with next/prev buttons; items are checkable."
    },
    "slider_change": {
      "targets": ["carat", "price", "quality", "clarity", "transparency", "length", "width", "lwr"],
      "sync": "two-way",
      "text_inputs": "onchange='scrollSlider(event, facet)' style",
      "effect": "update hidden low/high; refresh results; format min/max boxes."
    },
    "dropdown_toggle": {
      "targets": ["origin", "pair", "treatments", "certificate", "color_intensity"],
      "ux": "click to open panel with checkbox list; outside click closes."
    },
    "additional_filters_toggle": {
      "selector": ".showfilter.additionalfilter.filterdisplay",
      "show_hide": "toggle(section='.new-filters')"
    },
    "sort_change": {
      "selector": "#bottom_sortby",
      "options": ["FHTL","PLTH","PHTL","WLTH","WHTL","QHTL","QLTH"],
      "effect": "re-sort current result set"
    },
    "per_page_change": {
      "selector": "#short_number",
      "effect": "update pagination"
    },
    "view_toggle": {
      "list": ".listviewproduct",
      "grid": ".gridviewwproduct",
      "effect": "switch card layout"
    },
    "compare_add": {
      "selector": ".compare_link",
      "counter": "#compCnt",
      "feedback_tooltip": ".tooltips_comp"
    }
  },

  "a11y": {
    "aria_live": "swiper wrappers use aria-live='polite'",
    "roles": ["button", "group", "link"],
    "keyboard": {
      "sliders": "jQuery UI handles are tabbable",
      "carousel_buttons": "tabindex and aria-label present"
    },
    "tooltips": "data-toggle='tooltip' with titles"
  },

  "styling_tokens": {
    "sticky": "filtersticky",
    "section_label": "filterlabel",
    "row_wrap": "filterwrapper row",
    "border_rule": "bordernottom",
    "dropdown": {
      "root": "select-choose",
      "title": "select-choose__title",
      "list": "select-choose__list",
      "item": "select-choose__item",
      "placeholder_label": "placeholder_label"
    },
    "carousel_item": {
      "li": "nocheckbox filterToolTip swiper-slide",
      "text": "stoneName",
      "img": "img within <a>",
      "color_chip_classes": ["shape blue","shape yellow","shape teal","..."]
    },
    "sliders": {
      "track": "ui-slider ui-corner-all ui-slider-horizontal ui-widget ui-widget-content",
      "track_vertical": "ui-slider-vertical",
      "range": "ui-slider-range ui-corner-all ui-widget-header",
      "handle": "ui-slider-handle ui-corner-all ui-state-default",
      "scale": "ui-slider-label horizontal-label-step-slider"
    },
    "result_bar": {
      "sort_wrapper": "gray-select",
      "custom_select_wrapper": "sbHolder"
    }
  },

  "formatting_rules": {
    "price_input": "may contain commas (e.g., '2,002,850'); parse to number",
    "units": {
      "carat": "ct",
      "price": "USD",
      "length_width": "mm",
      "lwr": "ratio"
    }
  },

  "defaults_and_bounds": {
    "carat": { "min": 0.01, "max": 89.0, "initial_min": 0.01, "initial_max": 89.0 },
    "price": { "min": 200, "max": 2002850, "initial_min": 200, "initial_max": 2002850 },
    "quality": { "min": 0, "max": 5, "initial_min": 0, "initial_max": 5 },
    "clarity": { "min": 0, "max": 5, "initial_min": 0, "initial_max": 5 },
    "transparency": { "min": 0, "max": 3, "initial_min": 0, "initial_max": 3 },
    "length": { "min": 3.5, "max": 50, "initial_min": 3.5, "initial_max": 50 },
    "width": { "min": 2.5, "max": 1000, "initial_min": 2.5, "initial_max": 1000 },
    "lwr": { "min": 0.05, "max": 2.6, "initial_min": 0.05, "initial_max": 2.6 },
    "per_page": 24,
    "view": "gallery",
    "sort": "FHTL"
  },

  "derived_behavior": {
    "quality_scale_render": "show labels A…AAAAA with sublabels (Good…Untreated Heirloom) along track",
    "clarity_scale_render": "5-step vertical with text at steps",
    "transparency_scale_render": "3-step vertical",
    "result_count_binding": "set #total_count to filtered length",
    "toggle_text": "switch Show/Hide Additional Filters text",
    "tooltips": "show on hover for carousel items"
  },

  "portability_guidance": {
    "facet_key_convention": "use data-target values as canonical keys",
    "value_canonical_vs_display": "use input[data] as canonical, input[v] as display label",
    "slider_bindings": "keep min/max text boxes in sync; sanitize commas",
    "accessibility": "retain aria-* and keyboard tab stops",
    "theming": "keep class hooks; visual design can be re-skinned"
  }
}
